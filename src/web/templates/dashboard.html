{% extends "base.html" %}
{% set active_page = 'dashboard' %}
{% block title %}Dashboard - PondMonitor{% endblock %}
{% block page_title %}Dashboard{% endblock %}
{% block page_subtitle %}Přehled úrovně vody a odtoku{% endblock %}

{% block page_css %}
<link href="{{ url_for('static', filename='css/dashboard.css') }}" rel="stylesheet">
{% endblock %}

{% block content %}
<!-- Statistics cards -->
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
  <div class="stat-card">
    <div class="stat-icon blue">
      <svg fill="currentColor" viewBox="0 0 20 20" style="width: 1.5rem; height: 1.5rem;">
        <path fill-rule="evenodd" d="M5 2a1 1 0 011 1v1h1a1 1 0 010 2H6v1a1 1 0 01-2 0V6H3a1 1 0 010-2h1V3a1 1 0 011-1zm0 10a1 1 0 011 1v1h1a1 1 0 110 2H6v1a1 1 0 11-2 0v-1H3a1 1 0 110-2h1v-1a1 1 0 011-1zM12 2a1 1 0 01.967.744L14.146 7.2 17.5 9.134a1 1 0 010 1.732L14.146 12.8l-1.179 4.456a1 1 0 01-1.934 0L9.854 12.8 6.5 10.866a1 1 0 010-1.732L9.854 7.2l1.179-4.456A1 1 0 0112 2z" clip-rule="evenodd"></path>
      </svg>
    </div>
    <div class="stat-value" id="currentLevel">- cm</div>
    <div class="stat-label">Aktuální hladina</div>
  </div>
  
  <div class="stat-card">
    <div class="stat-icon green">
      <svg fill="currentColor" viewBox="0 0 20 20" style="width: 1.5rem; height: 1.5rem;">
        <path fill-rule="evenodd" d="M12.316 3.051a1 1 0 01.633 1.265l-4 12a1 1 0 11-1.898-.632l4-12a1 1 0 011.265-.633zM5.707 6.293a1 1 0 010 1.414L3.414 10l2.293 2.293a1 1 0 11-1.414 1.414l-3-3a1 1 0 010-1.414l3-3a1 1 0 011.414 0zm8.586 0a1 1 0 011.414 0l3 3a1 1 0 010 1.414l-3 3a1 1 0 11-1.414-1.414L16.586 10l-2.293-2.293a1 1 0 010-1.414z" clip-rule="evenodd"></path>
      </svg>
    </div>
    <div class="stat-value" id="currentOutflow">- l/s</div>
    <div class="stat-label">Aktuální odtok</div>
  </div>
  
  <div class="stat-card">
    <div class="stat-icon yellow">
      <svg fill="currentColor" viewBox="0 0 20 20" style="width: 1.5rem; height: 1.5rem;">
        <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"></path>
      </svg>
    </div>
    <div class="stat-value" id="maxLevel24h">- cm</div>
    <div class="stat-label">Max hladina (24h)</div>
  </div>
  
  <div class="stat-card">
    <div class="stat-icon purple">
      <svg fill="currentColor" viewBox="0 0 20 20" style="width: 1.5rem; height: 1.5rem;">
        <path fill-rule="evenodd" d="M12 7a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0V8.414l-4.293 4.293a1 1 0 01-1.414 0L8 10.414l-4.293 4.293a1 1 0 01-1.414-1.414l5-5a1 1 0 011.414 0L11 10.586 14.586 7H12z" clip-rule="evenodd"></path>
      </svg>
    </div>
    <div class="stat-value" id="levelTrend">-</div>
    <div class="stat-label">Trend hladiny</div>
  </div>
</div>

<!-- Charts with Controls -->
<div class="card" style="margin-bottom: 2rem;">
  <!-- Controls Header -->
  <div class="card-header">
    <div style="display: flex; flex-wrap: wrap; align-items: center; justify-content: space-between; gap: 1rem;">
      {% from 'macros/charts.html' import render_manual_date_selector, render_time_range_controls %}
      <!-- Manual range selector -->
      {{ render_manual_date_selector() }}
      <!-- Quick range buttons -->
      {{ render_time_range_controls() }}
    </div>
  </div>

  <!-- Charts Content -->
  <div class="charts-section">
    <div class="charts-grid">
      {% from 'macros/charts.html' import render_chart_container %}
      <!-- Level Chart -->
      {{ render_chart_container('chartLevel', 'Výška hladiny', 'levelDataPoints') }}
      <!-- Outflow Chart -->
      {{ render_chart_container('chartOutflow', 'Odtok', 'outflowDataPoints') }}
    </div>
  </div>
</div>

<!-- Export options -->
<div class="card">
  <div class="card-header">
    <h3 class="chart-title">Export dat</h3>
  </div>
  <div class="card-body">
    {% from 'macros/forms.html' import render_export_buttons %}
    {{ render_export_buttons() }}
  </div>
</div>
{% endblock %}

{% block page_js %}
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
{% endblock %}