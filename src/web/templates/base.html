<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% block title %}PondMonitor{% endblock %}</title>
  
  <!-- Modular CSS -->
  <link href="{{ url_for('static', filename='css/base.css') }}" rel="stylesheet">
  <link href="{{ url_for('static', filename='css/layout.css') }}" rel="stylesheet">
  <link href="{{ url_for('static', filename='css/components.css') }}" rel="stylesheet">
  <link href="{{ url_for('static', filename='css/charts.css') }}" rel="stylesheet">
  <link href="{{ url_for('static', filename='css/utilities.css') }}" rel="stylesheet">
  {% block page_css %}{% endblock %}
  
  <!-- Highcharts -->
  <script src="https://code.highcharts.com/stock/highstock.js"></script>
  <script src="https://code.highcharts.com/modules/accessibility.js"></script>
  {% block chart_modules %}{% endblock %}
  
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='favicon.png') }}">
  
  {% block head %}{% endblock %}
</head>
<body>
  <!-- Loading indicator -->
  <div id="loadingIndicator" class="loading-indicator" style="transform: scaleX(0);"></div>
  
  <!-- Error toast -->
  <div id="errorToast" class="toast error" style="transform: translateX(calc(100% + 2rem));">
    <div style="display: flex; align-items: center;">
      <svg style="width: 1.25rem; height: 1.25rem; margin-right: 0.5rem;" fill="currentColor" viewBox="0 0 20 20">
        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
      </svg>
      <span id="errorMessage"></span>
    </div>
  </div>

  <div style="min-height: 100vh; display: flex;">
    <!-- Mobile menu overlay -->
    <div id="mobileOverlay" class="mobile-overlay" onclick="toggleMobileMenu()"></div>
    
    <!-- Sidebar -->
    <div id="sidebar" class="sidebar" style="width: 16rem;">
      <div style="padding: 1.5rem;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
          <h1 class="text-gradient" style="font-size: 1.5rem; font-weight: 800;">PondMonitor</h1>
          <!-- Close button for mobile -->
          <button id="mobileCloseBtn" onclick="toggleMobileMenu()" style="display: none; background: none; border: none; color: var(--text-primary); cursor: pointer; padding: 0.5rem;">
            <svg style="width: 1.5rem; height: 1.5rem;" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
            </svg>
          </button>
        </div>
        
        <!-- Connection status -->
        <div id="connectionStatus" class="connection-status">
          <div style="display: flex; align-items: center; font-size: 0.875rem;">
            <div id="statusIndicator" class="status-indicator" style="background-color: #9ca3af;"></div>
            <span id="statusText" class="text-secondary">Kontrola připojení...</span>
          </div>
        </div>
        
        {% from 'macros/navigation.html' import render_navigation, render_theme_toggle %}
        {{ render_navigation() }}
        {{ render_theme_toggle() }}
      </div>
    </div>

    <!-- Main content -->
    <div class="main-content" style="flex: 1; display: flex; flex-direction: column;">
      <!-- Header -->
      <header class="header">
        <div style="padding: 1rem 2rem;">
          <div style="display: flex; align-items: center; justify-content: space-between;">
            <div style="display: flex; align-items: center;">
              <!-- Mobile menu button -->
              <button id="mobileMenuBtn" onclick="toggleMobileMenu()" style="display: none; background: none; border: none; color: var(--text-primary); cursor: pointer; padding: 0.5rem; margin-right: 1rem;">
                <svg style="width: 1.5rem; height: 1.5rem;" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path>
                </svg>
              </button>
              <div>
                <h2 style="font-size: 1.875rem; font-weight: 700; margin: 0; color: var(--text-primary);">{% block page_title %}{% endblock %}</h2>
                <p class="text-secondary" style="margin: 0.25rem 0 0 0; font-size: 0.875rem;">{% block page_subtitle %}{% endblock %}</p>
              </div>
            </div>
            <div style="display: flex; align-items: center; gap: 1rem;">
              <!-- Last update indicator -->
              <div id="lastUpdate" class="text-muted" style="font-size: 0.875rem;">
                <span>Poslední aktualizace: </span>
                <span id="lastUpdateTime">-</span>
              </div>
            </div>
          </div>
        </div>
      </header>

      <!-- Page content -->
      <main style="flex: 1; padding: 2rem; overflow: auto;">
        {% block content %}{% endblock %}
      </main>
    </div>
  </div>

  <!-- Core JavaScript modules -->
  <script src="{{ url_for('static', filename='js/base.js') }}"></script>
  <script src="{{ url_for('static', filename='js/charts.js') }}"></script>
  {% block page_js %}{% endblock %}
</body>
</html>